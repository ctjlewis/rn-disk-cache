"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("path");function a(e){return e&&"object"==typeof e&&"default"in e?e:{"default":e}}var o=a(require("react-native-fs"));const{DocumentDirectoryPath:t,mkdir:n,readDir:c,readFile:s,unlink:i,writeFile:r}=o.default,l=e.join(t,"__caches__");exports.fromDiskCache=async(a,o,t=3600)=>{const u=e.join(l,a);await n(u);const h=(await c(u)).sort(((e,a)=>Number(a.name)-Number(e.name))),g=h[0],d=g?Number(g.name):0,f=async()=>{console.log("Writing new cache value.");const a=await o(),t=Date.now(),n=e.join(u,`${t}`),c=JSON.stringify(a);if(console.log("LENGTH",h.length),h.length>1){console.log("Deleting old caches.");const e=h.slice(1);await Promise.all(e.map((async e=>await i(e.path))))}return await r(n,c),a};if(!h.length)return console.log("No caches found."),await f();const w=(Date.now()-d)/1e3,m=w>=t;return console.log(`Caches found for store: ${a}`,{cacheIsStale:m,secondsOld:w}),m?(console.log("Cache is stale."),await f()):(console.log("Cache is not stale."),await(async()=>{console.log("Reading most recent cache value.");const a=e.join(u,g.name);return JSON.parse(await s(a))})())};
//# sourceMappingURL=rn-disk-cache.production.min.cjs.map
