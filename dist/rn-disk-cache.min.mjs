import{join as e}from"path";import o from"react-native-fs";const{DocumentDirectoryPath:a,mkdir:t,readDir:n,readFile:c,unlink:s,writeFile:r}=o,i=e(a,"__caches__"),l=async(o,a,l=3600)=>{const g=e(i,o);await t(g);const h=await n(g),w=h.sort()[h.length-1],u=w?Number(w.name):0,f=async()=>{console.log("Writing new cache value.");const o=await a(),t=Date.now(),n=e(g,`${t}`),c=JSON.stringify(o);console.log("Deleting existing caches.");for(const e of h)s(e.path);return await r(n,c),o};if(!h.length)return console.log("No caches found."),await f();const m=(Date.now()-u)/1e3,d=m>=l;return console.log(`Caches found for store: ${o}`,{cacheIsStale:d,secondsOld:m}),d?(console.log("Cache is stale."),await f()):(console.log("Cache is not stale."),await(async()=>{console.log("Reading most recent cache value.");const o=e(g,w.name);return JSON.parse(await c(o))})())};export{l as fromDiskCache};
export default {};
//# sourceMappingURL=rn-disk-cache.min.mjs.map
